

---
title: "Tcp三次握手和四次挥手"
date: 2022-05-04
categories:
- tranquilpeak
- features
tags:
- tcp
- 计算机网络
# keywords:
# - tcp
# - 计算机网络

thumbnailImagePosition: left
# thumbnailImage: //d1u9biwaxjngwg.cloudfront.net/elements-showcase/vintage-140.jpg
---

<!--more-->

### Tcp三次握手和四次挥手



#### 三次握手

在连接的场景上，双方都需要向对方请求连接，交换双方的交易偏移量，并且得到对方的回应

![](/img/tcp1.png)

那如果是两次握手呢，两次握手就意味着，服务端没有接收到客户端的应答，客户端是可以随便想服务端发送消息了，但是服务端不能确定客户端准备好了没有，不敢轻易发送消息，这就违背了连接全双工的定义，全双工就意味着双方都能互相发送消息，所以两次五首肯定是不行的

#### 四次挥手

当双方都要请求关闭连接时就需要四次挥手了

![](/img/tcp2.png)

那四次挥手可不可以合并成三次挥手呢，答案是不行的，全双工的tcp连接双方都在工作，客户端停止以后不能保证服务端正好也工作完成了，所以挥手必须四次。tcp的四次挥手总有一方需要保持连接状态来等待另一方的释放连接，所以tcp四次挥手时最后会启用一个定时器，等待一段时间都没有收到消息，最后就会释放连接，这样就会出现连接并没有释放的概率,所以从某种程度来讲tcp是不完美的。不过tcp 本身有心跳机制，偶尔释放不了也没关系 超时了自然会断开连接。



Tips :一句话解释：确认双方都有收发能力